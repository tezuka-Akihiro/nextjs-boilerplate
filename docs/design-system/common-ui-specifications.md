# tsumiage サイト共通UI仕様書

## 📋 概要

tsumiageプロジェクトにおけるサイト全体で共通利用される機能パーツの仕様を定義します。各サービス（積み上げ・SNS）を横断する共通UI要素と、その統合されたユーザー体験について記述します。

### 適用範囲
- グローバルヘッダー・フッター
- サービス間ナビゲーション
- システム共通モーダル・通知
- ガジェットテーマ統合適用

---

## 🌐 グローバルヘッダー仕様

### 基本構成
```
┌─────────────────────────────────────────────────────────────┐
│ [🤖 tsumiage] [積み上げ] [SNS]    [2.4%] [💪 42%] [🔔] [👤] │
└─────────────────────────────────────────────────────────────┘
```

### 要素構成

#### ロゴ・ブランドエリア
- **配置**: ヘッダー左端
- **内容**: 
  - ロゴアイコン `🤖` + `tsumiage`ロゴタイプ
  - ホームへのリンク（全サービス共通ダッシュボード）
- **スタイリング**: サイバーブルー(`#00D9FF`)でグロー効果

#### サービス切り替えナビゲーション
- **配置**: ロゴ右側
- **構成**:
  - `積み上げ`: 男磨き積み上げサービス  
  - `SNS`: 男磨きSNSサービス
- **状態表現**:
  - アクティブサービス: サイバーブルー背景 + グロー効果
  - 非アクティブ: 半透明状態
- **インタラクション**: ホバー時にパルスアニメーション

#### ユーザー情報表示エリア
- **配置**: ヘッダー右側
- **表示内容**:
  - `%: 25`: 現在の経験値（確率表示）
  - `💪 42%`: 半年以内に彼女ができる確率
- **更新**: リアルタイム更新（WebSocket連携）
- **スタイリング**: ホログラム風表示

#### 通知・ユーザーメニュー
- **通知アイコン** `🔔`:
  - 未読通知件数バッジ表示
  - クリックで通知センター展開
- **ユーザーメニュー** `👤`:
  - プロフィール設定へのアクセス
  - ログアウト機能

### レスポンシブ対応

#### デスクトップ表示 (1024px以上)
```
[🤖 tsumiage] [積み上げ] [SNS]              [2.4%] [💪 42%] [🔔] [👤]
```

#### モバイル表示 (768px未満)
```
[☰] [🤖]                                    [2.4%] [🔔] [👤]
```
- ハンバーガーメニュー(`☰`)でサービス切り替えを格納
- 確率表示は省略（タップで詳細表示）

---

## 🧭 サービス内セクション切り替え

### 基本仕様
各サービス内での機能セクション間切り替えを管理します。ページ遷移を行わず、SPAとしてのセクション切り替えを実装。


### 男磨き積み上げサービス内
```
┌───────────────────────────────────────────────────┐
│ [📈 習慣記録] [⏰ 期日管理] [📊 ストリーム] [📈 統計] │
└───────────────────────────────────────────────────┘
```

### 男磨きSNSサービス内
```
┌─────────────────────────────────────────────────┐
│ [✏️ 投稿] [📰 タイムライン] [💬 定型コメント] [🏆 ランキング] │
└─────────────────────────────────────────────────┘
```

### セクション切り替えアニメーション
- **フェードイン/アウト**: 300ms ease-in-out
- **スライド効果**: 左右50pxスライド + フェード
- **アクティブ表示**: 下線アニメーション + グロー効果

---

## 🦶 グローバルフッター仕様

### 基本構成
```
┌─────────────────────────────────────────────────────────┐
│                                                         │
│ tsumiage - 男磨きSNS・習慣化アプリ                         │
│                                                         │
│ [利用規約] [プライバシーポリシー] [お問い合わせ] [ヘルプ]      │
│                                                         │  
│ © 2024 tsumiage Project. All rights reserved. v1.0.0   │
└─────────────────────────────────────────────────────────┘
```

### フッター要素

#### サイト情報
- **メインコピー**: 「tsumiage - 男磨きSNS・習慣化アプリ」
- **説明文**: 簡潔なプロダクト説明（1-2行）

#### 法的リンク
- **利用規約**: 外部ページまたはモーダル表示
- **プライバシーポリシー**: GDPR・個人情報取り扱い
- **お問い合わせ**: サポートフォームへのリンク
- **ヘルプ**: FAQ・使い方ガイド

#### バージョン情報
- **コピーライト**: 年度・権利者情報
- **バージョン**: アプリケーションバージョン表示

### スタイリング
- **背景**: 濃いグレー/ブラック（`#1a1a1a`）
- **テキスト**: 薄いグレー（`#cccccc`）
- **リンク**: サイバーブルー(`#00D9FF`) + ホバー効果

---

## 💬 システム共通モーダル仕様

### 1. 汎用確認ダイアログ

#### 基本構造
```
┌─────────────────────────────┐
│ ⚠️  確認                    │
│                            │
│ 本当に削除してもよろしいですか？  │
│                            │
│    [キャンセル]  [削除実行]    │
└─────────────────────────────┘
```

#### バリエーション
- **削除確認**: ⚠️ 警告アイコン + 赤色アクセント
- **保存確認**: 💾 保存アイコン + 青色アクセント
- **送信確認**: 📤 送信アイコン + 緑色アクセント

#### 実装仕様
- **オーバーレイ**: 50%透明度の黒背景
- **アニメーション**: フェードイン + 中央からズーム
- **キーボード対応**: Escapeでキャンセル、Enterで実行

### 2. システムアラート・エラー表示

#### 成功通知
```
┌─────────────────────────────┐
│ ✅ 投稿が完了しました        │
│    経験値 +1.0pt 獲得！     │
└─────────────────────────────┘
```

#### エラー通知
```
┌─────────────────────────────┐
│ ❌ 通信エラー               │
│    しばらく待ってから       │
│    もう一度お試しください    │
└─────────────────────────────┘
```

#### 表示制御
- **表示時間**: 成功3秒、エラー5秒
- **位置**: 画面右上にトースト表示
- **スタッキング**: 複数通知の縦積み
- **自動消去**: タイマー + 手動×ボタン

### 3. ローディング・処理中表示

#### スピナー表示
```
┌─────────────────────────────┐
│         🔄                 │
│    処理中です...           │
│    しばらくお待ちください    │
└─────────────────────────────┘
```

#### 進捗バー表示
```
┌─────────────────────────────┐
│ アップロード中... (45%)     │
│ ████████████░░░░░░░         │
└─────────────────────────────┘
```

---

## 🔔 通知システムUI仕様

### 1. リアルタイム通知ポップアップ

#### 通知タイプ
- **習慣記録通知**: 「田中さんが筋トレを記録しました」
- **投稿通知**: 「新しい彼女GET投稿があります」
- **ランキング更新**: 「あなたのランキングが上がりました」
- **システム通知**: メンテナンス・アップデート情報

#### 表示スタイル
```
┌─────────────────────────────────┐
│ 🏃‍♂️ 田中さんが筋トレを記録        │
│    2分前 • +0.2pt              │
│                        [×]     │
└─────────────────────────────────┘
```

### 2. 通知センター・履歴表示

#### 通知一覧UI
```
┌─────────────────────────────────────────┐
│ 🔔 通知センター               [全既読] │
├─────────────────────────────────────────┤
│ ● 🏃‍♂️ 田中さんが筋トレを記録           │
│   2分前                               │
├─────────────────────────────────────────┤
│   💕 山田さんがデート投稿しました        │
│   15分前                              │
├─────────────────────────────────────────┤
│   🏆 週間ランキングが更新されました      │
│   1時間前                             │
└─────────────────────────────────────────┘
```

#### 機能仕様
- **未読表示**: 左端の●マーク
- **既読操作**: タップで個別既読、「全既読」で一括処理
- **フィルター**: 通知タイプ別表示切り替え
- **履歴管理**: 30日間保持、自動削除

### 3. WebSocket連携仕様

#### リアルタイム更新対象
- **通知受信**: サーバーからのプッシュ通知
- **経験値更新**: %・確率表示のリアルタイム反映
- **ストリーム更新**: 他ユーザーの活動表示
- **ランキング更新**: 順位変動の即座反映

#### 接続管理
- **接続状態表示**: ヘッダーに接続インジケーター
- **再接続処理**: 自動リトライ + 手動再接続
- **オフライン対応**: キューイング + 復帰時同期

---

## 🎪 ガジェットテーマ統合適用

### 共通スタイリング原則

#### カラーパレット適用
- **プライマリ**: サイバーブルー(`#00D9FF`)
- **セカンダリ**: ネオングリーン(`#39FF14`)
- **アクセント**: エレクトリックパープル(`#BF00FF`)
- **背景**: ダークグレー系（`#1a1a1a`、`#2d2d2d`）

#### エフェクト適用

##### グロー効果
```css
.glow-primary {
  box-shadow: 0 0 20px rgba(0, 217, 255, 0.5);
  text-shadow: 0 0 10px rgba(0, 217, 255, 0.8);
}
```

##### ホログラム風カード
```css
.hologram-card {
  background: linear-gradient(45deg, 
    rgba(0, 217, 255, 0.1), 
    rgba(191, 0, 255, 0.1));
  border: 1px solid rgba(0, 217, 255, 0.3);
  backdrop-filter: blur(10px);
}
```

##### パルスアニメーション
```css
.pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

@keyframes pulse-glow {
  0%, 100% { box-shadow: 0 0 5px rgba(0, 217, 255, 0.5); }
  50% { box-shadow: 0 0 25px rgba(0, 217, 255, 0.8); }
}
```

### 適用箇所

#### ヘッダー要素
- **ロゴ**: グロー効果 + ホバー時パルス
- **ナビゲーション**: アクティブ状態でグロー
- **ユーザー情報**: ホログラム風背景

#### モーダル・通知
- **モーダル背景**: ホログラム風半透明
- **ボタン**: グロー効果 + ホバー時拡張
- **通知ポップアップ**: サイバーフレーム + パルス

#### インタラクション
- **ホバー状態**: グロー強度アップ
- **クリック状態**: パルス + 色変化
- **フォーカス状態**: ボーダーグロー

---

## ⚡ インタラクション仕様

### セクション切り替えアニメーション

#### フェード・スライド
```javascript
// セクション切り替え時の基本アニメーション
const sectionTransition = {
  enter: {
    opacity: 0,
    x: 50,
    transition: { duration: 0.3, ease: "easeInOut" }
  },
  animate: {
    opacity: 1,
    x: 0
  },
  exit: {
    opacity: 0,
    x: -50
  }
}
```

#### ナビゲーション状態管理
- **アクティブ状態**: 即座に視覚反映
- **ローディング状態**: スケルトン表示
- **エラー状態**: エラーメッセージ + リトライオプション

### 通知アニメーション

#### ポップアップ表示
```javascript
// 通知ポップアップのアニメーション
const notificationAnimation = {
  initial: { opacity: 0, y: -20, scale: 0.9 },
  animate: { opacity: 1, y: 0, scale: 1 },
  exit: { opacity: 0, y: -20, scale: 0.9 },
  transition: { duration: 0.2, ease: "easeOut" }
}
```

#### 積み重ね管理
- **新規通知**: 上から下へプッシュ
- **消去時**: フェードアウト + 上詰め
- **最大表示数**: 5件まで、超過分は自動削除

### モーダルインタラクション

#### 開閉アニメーション
```javascript
// モーダル開閉アニメーション
const modalAnimation = {
  overlay: {
    initial: { opacity: 0 },
    animate: { opacity: 1 },
    exit: { opacity: 0 }
  },
  content: {
    initial: { opacity: 0, scale: 0.8, y: 20 },
    animate: { opacity: 1, scale: 1, y: 0 },
    exit: { opacity: 0, scale: 0.8, y: 20 }
  }
}
```

#### キーボード・アクセシビリティ
- **Tab順序**: 論理的なフォーカス移動
- **Escape**: モーダル・ドロップダウン閉じる
- **Enter/Space**: ボタンアクティベート
- **Arrow Keys**: メニュー内移動

---

## 🔧 状態管理・データ連携

### グローバル状態管理

#### 状態構造
```typescript
interface GlobalState {
  user: {
    id: string
    nickname: string
    experience: number
    probability: number
    status: 'single' | 'dating' | 'relationship'
  }
  notifications: {
    unreadCount: number
    items: NotificationItem[]
    isConnected: boolean
  }
  navigation: {
    currentService: 'records' | 'sns'
    currentSection: string
    isLoading: boolean
  }
}
```

#### 更新トリガー
- **ユーザー情報**: 認証状態変更、プロフィール更新
- **経験値**: 各種アクション実行時
- **通知**: WebSocket受信、手動既読操作
- **ナビゲーション**: サービス・セクション切り替え

### WebSocket接続管理

#### 接続仕様
```typescript
interface WebSocketConnection {
  url: string
  protocols: ['v1.notifications', 'v1.updates']
  reconnectInterval: number // 5000ms
  maxReconnectAttempts: number // 10
  heartbeatInterval: number // 30000ms
}
```

#### イベントハンドリング
- **接続**: 認証トークン送信、購読設定
- **受信**: 通知・更新データの処理・反映
- **切断**: 自動再接続、オフライン状態表示
- **エラー**: エラー表示、手動再接続オプション

### サービス間データ共有

#### 共有データ
- **ユーザープロフィール**: 全サービス共通
- **経験値・確率**: リアルタイム同期
- **通知設定**: 各サービスの通知設定統合
- **アクティビティログ**: 横断的な行動履歴

#### データ同期タイミング
- **即座同期**: 経験値獲得、重要状態変更
- **定期同期**: 5分間隔でバックグラウンド同期
- **手動同期**: プルリフレッシュ、エラー復旧時

---

## 🎯 実装優先度

### Phase 1: 必須機能 (MVP)
- [x] グローバルヘッダー（基本構成）
- [x] サービス切り替えナビゲーション
- [x] 基本モーダル（確認ダイアログ）
- [x] 通知表示（基本トースト）
- [x] フッター（基本情報）

### Phase 2: 体験向上
- [ ] 通知センター・履歴
- [ ] WebSocketリアルタイム更新
- [ ] 高度なアニメーション
- [ ] レスポンシブ最適化

### Phase 3: 拡張機能
- [ ] オフライン対応
- [ ] プッシュ通知連携
- [ ] アクセシビリティ完全対応
- [ ] パフォーマンス最適化

---

## 📚 関連ドキュメント

### デザインシステム
- **[Brand Identity](./brand-identity.md)** - ブランド・色・フォント仕様
- **[Layout System](./layout-system.md)** - グリッド・レイアウト・レスポンシブ
- **[Design Architecture](./design-architecture.md)** - デザインシステム設計・管理手法

### 実装ガイド
- **[Frontend Implementation Guide](../guides/frontend-implementation-guide.md)** - フロントエンド実装指針
- **[Development Guidelines](../guides/development-guidelines.md)** - 開発ガイドライン

### アーキテクチャ
- **[System Architecture](../architecture/system-architecture.md)** - システム全体設計
- **[API Specification](../architecture/api-specification.md)** - API仕様

---

> **💡 Key Principle**: 
> 共通UI仕様は「一貫性」と「使いやすさ」の両立を目指します。
> ガジェットテーマによる独特な世界観を保ちながら、直感的で分かりやすいインターフェースを提供します。

> **🎯 Implementation Goal**:
> サービス横断で統一されたユーザー体験を提供し、
> ユーザーが迷わずに各機能を利用できる環境を構築します。